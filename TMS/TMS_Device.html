<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>小規模連線加值管理系統 - TMS 業者設備維護</title>
    <link rel="stylesheet" href="TMS_Device.css" />
    <!-- 加入 SheetJS 套件 -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  </head>
  <body>
    <div class="header">
      <div class="header-title">
        <span>🔒</span>
        <span>小規模連線加值管理系統 - TMS 業者設備維護</span>
      </div>
    </div>

    <div class="breadcrumb">
      <a href="#">🏠</a> / <a href="#">小規模連線加值管理系統</a> / 業者設備
    </div>

    <div class="content">
      <!-- 頁籤導航 -->
      <div class="tab-navigation">
        <button class="tab-btn active" data-tab="maintenance">
          設備清單維護
        </button>
        <button class="tab-btn" data-tab="import">匯入設備維護清單</button>
      </div>

      <!-- 設備清單維護頁籤 -->
      <div class="tab-content active" id="maintenanceTab">
        <div class="filter-section">
          <!-- 查詢/新增表單 -->
          <div class="query-form" id="queryForm" style="display: block">
            <div class="form-row">
              <div class="form-field">
                <label for="providerId">業者代碼</label>
                <div class="custom-select-wrapper">
                  <input
                    type="text"
                    id="providerIdSearch"
                    class="custom-select-search required-field"
                    placeholder="請選擇或搜尋業者"
                    autocomplete="off"
                  />
                  <div class="custom-select-dropdown" id="providerIdDropdown">
                    <div class="custom-select-option" data-value="">請選擇</div>
                    <div
                      class="custom-select-option"
                      data-value="C1010400"
                      data-text="C1010400(中興電工機械股份有限公司)"
                    >
                      C1010400(中興電工機械股份有限公司)
                    </div>
                    <div
                      class="custom-select-option"
                      data-value="C1010C00"
                      data-text="C1010C00(寶盛國際股份有限公司)"
                    >
                      C1010C00(寶盛國際股份有限公司)
                    </div>
                  </div>
                  <!-- 隱藏的 select，用於儲存實際值 -->
                  <select
                    id="providerId"
                    name="providerId"
                    style="display: none"
                  >
                    <option value="">請選擇</option>
                    <option value="C1010400">
                      C1010400(中興電工機械股份有限公司)
                    </option>
                    <option value="C1010C00">
                      C1010C00(寶盛國際股份有限公司)
                    </option>
                  </select>
                </div>
              </div>
              <div class="form-field">
                <label for="rwId">RW ID</label>
                <input
                  type="text"
                  id="rwId"
                  name="rwId"
                  placeholder="請輸入 RW ID"
                  class="required-field"
                />
              </div>
              <div class="form-field">
                <label for="samId">SAM ID</label>
                <input
                  type="text"
                  id="samId"
                  name="samId"
                  placeholder="請輸入 SAM ID"
                  class="required-field"
                />
              </div>
            </div>
            <div class="query-actions">
              <button class="btn-secondary" id="btnReset">重置</button>
              <button class="btn-primary" id="btnQuery">🔍 查詢</button>
              <button class="btn-success" id="btnAdd">➕ 新增</button>
            </div>
          </div>
        </div>

        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th style="width: 50px">
                  <input type="checkbox" id="checkAll" />
                </th>
                <th>業者代碼</th>
                <th>業者名稱</th>
                <th>Reader ID</th>
                <th>SAM ID</th>
                <th style="width: 80px">操作</th>
              </tr>
            </thead>
            <tbody id="deviceTableBody">
              <tr>
                <td><input type="checkbox" class="row-checkbox" /></td>
                <td>C1010400</td>
                <td>中興電工機械股份有限公司</td>
                <td>RW001</td>
                <td>SAM001</td>
                <td>
                  <button
                    class="btn-delete-single"
                    data-index="0"
                    title="刪除此筆資料"
                  >
                    ✕
                  </button>
                </td>
              </tr>
              <tr>
                <td><input type="checkbox" class="row-checkbox" /></td>
                <td>C1010400</td>
                <td>中興電工機械股份有限公司</td>
                <td>RW002</td>
                <td>SAM002</td>
                <td>
                  <button
                    class="btn-delete-single"
                    data-index="1"
                    title="刪除此筆資料"
                  >
                    ✕
                  </button>
                </td>
              </tr>
              <tr>
                <td><input type="checkbox" class="row-checkbox" /></td>
                <td>C1010C00</td>
                <td>寶盛國際股份有限公司</td>
                <td>RW003</td>
                <td>SAM003</td>
                <td>
                  <button
                    class="btn-delete-single"
                    data-index="2"
                    title="刪除此筆資料"
                  >
                    ✕
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="pagination">
          <div class="pagination-info">
            每頁
            <select class="page-size">
              <option>10</option>
              <option>25</option>
              <option>50</option>
              <option>100</option>
            </select>
          </div>
          <div class="pagination-controls">
            <button class="pagination-btn">⏮</button>
            <button class="pagination-btn">◀</button>
            <button class="pagination-btn">▶</button>
            <button class="pagination-btn">⏭</button>
            <!-- 刪除按鈕 (初始隱藏) -->
            <button
              class="btn-danger"
              id="btnDelete"
              style="display: none; margin-left: 15px"
            >
              🗑️ 刪除選取的項目 (<span id="deleteCount">0</span>)
            </button>
          </div>
        </div>
      </div>

      <!-- 匯入設備維護清單頁籤 -->
      <div class="tab-content" id="importTab">
        <div class="filter-section">
          <div class="import-section">
            <div class="import-instructions">
              <h3 style="margin-bottom: 10px; color: #333">檔案匯入說明</h3>
              <p>📋 請選擇要匯入的檔案，系統將自動讀取並預覽資料。</p>
              <p>
                📥 範例檔案下載：
                <a
                  href="TMS_Device_Import_Sample.xlsx"
                  download
                  style="color: #1976d2; text-decoration: underline"
                >
                  TMS_Device_Import_Sample.xlsx
                </a>
              </p>
            </div>
            <div class="file-info">
              <p><strong>支援檔案格式：</strong>CSV, Excel (.xlsx, .xls)</p>
              <p><strong>檔案大小限制：</strong>10MB</p>
              <p>
                <strong>必要欄位：</strong>任務(開通/註銷), 業者代碼, RW ID, SAM
                ID
              </p>
            </div>
            <div class="file-selector">
              <input
                type="file"
                id="fileInput"
                accept=".csv,.xlsx,.xls"
                style="display: none"
              />
              <button class="btn-secondary" id="btnSelectFile">
                📁 選擇檔案
              </button>
              <span
                id="fileName"
                style="margin-left: 15px; color: #666; font-weight: 500"
                >尚未選擇檔案</span
              >
            </div>
          </div>
        </div>

        <!-- 匯入預覽區 -->
        <div class="import-preview" id="importPreview" style="display: none">
          <div class="preview-header">
            <h3 style="color: #333; margin: 0">資料預覽</h3>
            <div class="preview-actions">
              <span id="previewCount" style="color: #666; margin-right: 15px"
                >共 0 筆資料</span
              >
              <button class="btn-secondary" id="btnClearPreview">
                清空預覽
              </button>
              <button
                class="btn-danger"
                id="btnRemoveSelected"
                style="display: none"
              >
                移除選取項目
              </button>
            </div>
          </div>

          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th style="width: 50px">
                    <input type="checkbox" id="checkAllImport" />
                  </th>
                  <th>業者代碼</th>
                  <th>業者名稱</th>
                  <th>Reader ID</th>
                  <th>SAM ID</th>
                  <th style="width: 100px">任務</th>
                </tr>
              </thead>
              <tbody id="importPreviewBody">
                <!-- 預覽資料會動態載入這裡 -->
              </tbody>
            </table>
          </div>

          <div class="import-actions">
            <button class="btn-secondary" id="btnCancelImport">取消匯入</button>
            <button class="btn-primary" id="btnExecuteImport">
              ✓ 執行匯入
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script src="TMS_Device.js"></script>
</html>
